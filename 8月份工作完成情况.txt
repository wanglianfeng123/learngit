1.协助运维解决线上盘组相关问题。
【U180设备】线上问题
    1）w层在修改升级配置文件时导致数据丢失问题。经过排查代码发现在修改地区编码字段时直接覆盖里面内容从而将之前数据一并覆盖掉导致数据丢失，目前已经全部json数据解析。已解决。
    2）W程序数据库存储多条重复的槽位号记录问题(ukey和税控盘)。经过排查代码发现是由于程序在读取设备编码失败后会在设置设备口令的过程中去添加一条记录，代码逻辑错误。已经优化完成，验证失败，排查中，未解决额    
    3) 前端开具报“证书口令为空，请先设置证书口令”的错误。目前看有如下几种情况发生：
       第一种：w层读取设备编码失败时程序会清空证书口令。目前这种已经进行优化修改。已解决
       第二种：经过排查是由于bin层在开卡失败返回证书口令校验失败，w层会清空证书口令。此问题具有一定偶然性，在调用接口进行证书口令校验时，盘掉电导致验证失败。目前w层解决方案就是在清空口令之前先判断一下盘是否掉电。已解决。
       第三种：是由于数据库种保存一个税号多条记录的情况，如果出现多天记录程序会删除当前税号所有相关信息。所有证书口令也会随之被清空。目前还在排查多条记录问题。未解决
       第四种：也是bin层证书口令校验失败，w层会清空证书口令。w层确实传入的口令错误导致被清空。传入错误的口令是12345678默认口令，税号被删除了，从新添加的新税号，可以确认是新添加的。经过进一步分析数据保存数据，
发现个别税号异常，存在多天异常记录。目前还在排查中。未解决
    4）票管家报“税务盘启动失败，请检查税务盘是否正常，以及证书口令是否正确，若无异常，请尝试重新插入税务盘”的错误。该错误是由于数据库中一个税号存储多条记录导致，目前还在排查中。未解决
    5）票管家报”重试两次后仍然无法读取金税盘“的问题。此问题是由于设备经常性掉电导致盘数据被清空。目前厂家已经现场维修设备。已解决。
    6）前端报“18999，成功未避免税务风险，请联网检查当前版本是否有更新”的错误。找到去优化开票流程解决方案并已经完成。目前在验证阶段。已解决
    7) 优化程序打印日志功能，将互斥锁替换为临界区的方式来支持打印日志函数线程安全，同时解决用互斥锁的方式打印日志时卡顿耗时严重问题。优化打印日志之后会降低以下线上业务运行异常的频率：
       第一：解决所有和通过管道通知工作线程退出失败导致业务执行超时的问题。
       第二：解决所有和启动bin进程包括加解锁超时慢导致相关业务执行超时的问题。 
       第三：解决L45个别设备开具慢问题。
       第四：解决票管家进行证书口令校验超时失败的问题。
    8)部分税控盘和局端交互业务失败的问题。接口方给的反馈意见是将skp接口报文里的局端ip换成域名。目前了解到该税盘本身就是ip无法更新成域名，需要从税局那里修改ip。目前事情就是这样。未解决
    9）前端开具报“本地数据库未找到订单数据，可尝试重新发送此订单”的错误。经过排查日志是由于设备端没有收到订单抓取的消息，导致本地数据没有当前流水号信息。最终前端在订单查询时报错了。长连接问题，偶发问题，持续观察中。已解决。
   10）u180设备开具8分钟开具成功慢的问题。经过排查日志发现是由于bin开卡失败报“接收数据失败，系统错误号(233)(错误代码:233)"错误导致耗时时间过长。此问题是组件接口和skfp.exe通信失败导致。偶发观察中。已解决。
   11）u180设备程序崩溃问题。经过排查发现是由于长连接断开导致崩溃。怀疑是由于connectionLost回调函数和Thread_Check_MQTT_connect函数同时调用connect_proc导致崩溃，已经对该函数进行加锁，目前线上已经最新程序。已解决
【L45设备】线上问题
    1）L45设备票源下载失败报”局端接口错误[9000006],发票信息下载失败“的错误。经过排查是由于跨月之后未进行清卡操作,导致票源下载失败。此问题是由于用户对于开具业务不熟导致。经过商讨此问题软件不予控制。已解决
    2）L45主控开具报“获取锁超时”的问题。经过排查日志发现是由于bin层在做业务时返回的太慢导致整体耗时时间过长。经过重装系统解决此问题。已解决
    3）L45设备开具报”发票开具失败，详情信息：189999，开具时密钥错误1“的错误。经过排查是由于该税号盘是新盘，需要在单机版上登录以达到激活的效果，否则无法开具等相关操作，通过指导用户问题已经解决。已解决
    4）L45设备中票管家报”税控设备口令错误：“的错误。此问题会有如下几种情况导致：
       第一种：w层读取设备编码失败时程序会清空证书口令。目前这种已经进行优化修改。已解决
       第二种：w层数据库中存储同一税号多条记录的情况下w层会清空所有记录，同时也会清空该税号对应的证书口令。目前一直在排查这种问题。未解决。
       第三种：bin层如果在进行证书口令校验失败时，w层会将数据库中保存的证书口令清空。线上出现的情况是，bin层给接口传入正确的口令调用接口校验时，恰巧设备掉电，导致证书口令校验失败。针对此种情况w层在清空口令时做了盘是否存在的判断；已解决
    5）L45设备插入盘之后，票管家中所有税控设备信息消失的问题。经过排查日志发现盘组上所有税控设备被下电导致票管家不显示了。目前怀疑是插盘的时候导致盘组短路了。设备问题，目前已经反馈给硬件厂商排查中。未解决
    6）L45设备新金税盘插入设备上报“开启金税盘失败: 安装开票软件时输入的销方纳税人识别号或地区编码不正确!”的错误。开票软件版本不对导致，目前已经在测试L45最新版本，等待验证升级。已解决
2.加密优盘。
    1）目前还在调研中，目前浙江的加密优盘无法支持sqlite3数据的增删改查的操作。
    2）开发多税号功能，目前在详细设计阶段。
  









